# HNX 微内核操作系统介绍

HNX 是一个采用 Rust 语言编写的现代微内核操作系统。它致力于实现内核空间与用户空间服务的清晰分离，以提供更高的安全性、模块化和可靠性。本操作系统目前主要支持 AArch64 架构，并通过 QEMU 进行仿真测试与开发。

## 核心架构

HNX 的设计围绕以下核心原则和组件展开：

### 微内核设计

- **最小化内核：** HNX 内核被设计为尽可能小，仅提供最基本的服务，包括：
    - **进程间通信 (IPC)：** 实现用户空间服务与内核以及服务之间的高效安全通信。
    - **内存管理：** 提供基础的物理和虚拟内存管理机制。
    - **调度：** 负责任务和进程的调度，确保系统资源的合理分配。

### 用户空间服务

与传统宏内核不同，HNX 将大部分核心功能作为独立的用户空间服务实现。这种设计模式增强了系统的模块性和鲁棒性，因为服务的崩溃通常不会影响整个系统的稳定性。

关键的用户空间服务包括：

- **Loader 服务：** 负责加载和管理用户空间程序。
- **VFS 服务 (虚拟文件系统服务)：** 提供统一的文件系统接口，管理不同存储设备的访问。
- **IPC Router 服务：** 负责服务注册、发现和消息路由，是服务间通信的核心枢纽。
- **ProcMgr 服务 (进程管理服务)：** 管理用户空间进程的生命周期，包括创建、销毁和状态监控。

### 基于能力的安全性

HNX 采用基于能力的访问控制模型，这是一种细粒度的安全机制。每个进程或线程仅被授予执行其任务所需的最小权限集合，从而有效地限制了潜在攻击的范围和影响。

### 跨平台支持

虽然当前主要集中在 AArch64 (ARMv8-A) 架构，并利用 QEMU 进行仿真，但 HNX 的设计考虑了跨平台的需求。通过抽象层和架构特定代码的清晰分离，HNX 旨在未来能够扩展到 x86_64、RISC-V 等其他处理器架构。

## 设计目标

- **安全性：** 通过微内核和能力模型，最大程度地减少攻击面。
- **模块化：** 灵活的服务架构使得系统组件可以独立开发、测试和部署。
- **可靠性：** 内核的精简和用户空间服务的隔离降低了系统整体故障的风险。
- **可扩展性：** 易于添加新的服务和支持新的硬件架构。

本手册将详细介绍 HNX 的各个组成部分、开发约定以及如何参与到项目中来。