# 用户空间组件 (User Space Components)

HNX 作为一个微内核操作系统，其大部分系统功能和服务都运行在用户空间中。这种设计哲学最大化了内核的精简性，将文件系统、网络协议栈、设备驱动等传统操作系统中的核心功能作为独立的用户空间进程来运行。这不仅提高了系统的模块化程度和安全性，也使得系统更加灵活和易于维护。

## 设计理念

-   **特权分离:** 关键系统服务运行在较低权限的用户空间，即使服务崩溃也不会导致整个系统崩溃。
-   **模块化与可替换:** 各个服务都是独立的进程，可以独立开发、升级和替换，互不影响。
-   **基于 IPC 通信:** 所有用户空间组件（包括服务和应用程序）都通过内核提供的 IPC 机制进行通信和协作。
-   **弹性与可靠性:** 通过将故障隔离在用户空间服务中，提高了系统的整体弹性和可靠性。

## 主要组成部分

HNX 用户空间主要由以下几个核心部分构成：

### HNX 系统库 (`hnxlib/`)

`hnxlib` 是 HNX 的核心系统库，为用户空间服务和应用程序提供了一套封装了底层系统调用的高级 API。它简化了用户程序与内核以及其他服务之间的交互，提供了方便的 IPC 接口、内存管理辅助功能和错误处理机制。

-   **功能:** 封装系统调用、IPC 客户端、内存分配接口、以及其他通用的实用函数。
-   **详细文档:** 更多信息请参考 [HNX 系统库](./hnxlib/hnxlib_intro.md)。

### C 标准库 (`libc/`)

`libc` 是 HNX 上 C 语言标准库的实现，为使用 C 语言编写的程序提供了标准 C 库函数。它是为了支持传统的 C/C++ 应用程序和库而存在的，提供了如内存操作、字符串处理、文件 I/O (通过 VFS 服务代理) 等基础功能。

-   **功能:** 提供标准 C 库函数，如 `malloc`, `free`, `printf`, `strcpy` 等。
-   **详细文档:** 更多信息请参考 [C 标准库](./libc/libc_intro.md)。

### 系统服务 (`services/`)

`services` 目录包含了 HNX 的所有核心系统服务，每个服务都是一个独立的用户空间进程，负责提供特定的系统功能。这些服务通过 IPC 相互协作，共同构成了 HNX 的完整功能。

-   **`init/` (初始化进程):** 作为用户空间的第一个进程 (PID 1)，负责启动和管理其他核心系统服务。
-   **`loader-service/` (服务加载器):** 负责加载和启动新的用户空间程序和动态库。
-   **`vfs-service/` (虚拟文件系统服务):** 提供统一的文件系统抽象和文件操作接口。
-   **`ipcrouter-service/` (IPC 路由服务):** 负责服务的注册、发现和 IPC 消息的路由。
-   **`procmgr-service/` (进程管理服务):** 负责用户空间进程的生命周期管理和状态监控。
-   **`echo-service/` (回显测试服务):** 一个简单的测试服务，用于演示 IPC 通信。
-   **`device-driver-server/`:** 将设备驱动运行在用户空间。
-   **`filesystem-server/`:** 用户空间文件系统服务。
-   **`network-server/`:** 用户空间网络协议栈服务。
-   **详细文档:** 更多信息请参考 [系统服务](./services/services_intro.md)。

### 应用程序 (`apps/`)

`apps` 目录包含在 HNX 上运行的用户应用程序。这些应用程序依赖于 `hnxlib` 和 `libc` 提供的 API 来与系统进行交互。

-   **`shell/`:** 一个基本的命令行 shell 程序，用于用户与 HNX 操作系统进行交互。
-   **详细文档:** 更多信息请参考 [应用程序](./apps/apps_intro.md)。

通过这种结构，HNX 旨在构建一个高度模块化、安全且易于扩展的现代操作系统。