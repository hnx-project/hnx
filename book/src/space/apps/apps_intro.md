# 用户空间应用程序 (User Space Applications)

在 HNX 微内核操作系统中，用户空间应用程序 (`space/apps`) 是指那些为用户提供具体功能、直接与用户进行交互的程序。与系统服务不同，应用程序通常不作为常驻后台进程运行，而是根据用户需求启动和终止。它们通过 HNX 系统库 (`hnxlib`) 和 C 标准库 (`libc`) 提供的接口与内核及系统服务进行交互。

## 设计原则

-   **用户交互:** 应用程序旨在提供用户友好的接口，无论是命令行界面 (CLI) 还是图形用户界面 (GUI)。
-   **功能独立:** 每个应用程序应专注于完成特定的任务，保持功能上的独立性。
-   **利用系统服务:** 应用程序通过 IPC 与系统服务通信，来访问文件系统、网络、进程管理等功能，而不是直接操作硬件或内核数据。
-   **鲁棒性:** 应用程序的崩溃不应影响系统服务的正常运行或整个操作系统的稳定性。

## 核心应用程序

### `shell/` (命令行 Shell)

`shell` 是 HNX 最基本的交互式用户应用程序，位于 `space/apps/shell` 目录下。它提供了一个命令行界面，允许用户输入命令、执行其他应用程序、管理文件和目录等。

-   **功能:**
    -   **命令解释与执行:** 解析用户输入的命令，并在 HNX 环境中执行相应的程序或内置命令。
    -   **进程管理:** 提供 `ps`, `kill` 等基本命令，允许用户查看和管理正在运行的进程（通过与 `procmgr-service` 交互）。
    -   **文件系统操作:** 允许用户执行 `ls`, `cd`, `cat` 等文件操作（通过与 `vfs-service` 交互）。
    -   **输入/输出:** 处理用户的键盘输入和程序输出，通常通过内核的控制台接口或终端模拟器进行。

-   **实现依赖:**
    -   `hnxlib`: 用于系统调用、IPC 通信。
    -   `libc`: 用于标准输入/输出、字符串处理等 C 库函数。

## 应用程序的构建与运行

-   **编译:** HNX 的应用程序使用 Rust 语言编写，通过 Cargo 和 Meson 构建系统进行编译。编译生成的可执行文件是针对 HNX 目标架构（如 AArch64）的 ELF 格式。
-   **部署:** 编译后的应用程序通常会包含在 Initrd 中，或者通过文件系统服务动态加载。
-   **执行:** 用户通过 `shell` 或其他方式启动应用程序。应用程序在启动后，会获得独立的虚拟地址空间和必要的能力。

## 模块间交互

-   **与 `hnxlib`:** 应用程序通过 `hnxlib` 提供的 API 来进行系统调用和 IPC。
-   **与 `libc`:** 对于需要 C 语言兼容性的应用程序，会使用 `libc` 提供的标准 C 库函数。
-   **与系统服务:** 应用程序不会直接与内核通信（除了通过 `hnxlib` 封装的系统调用），而是通过 IPC 与 `vfs-service` (文件操作)、`procmgr-service` (进程管理) 等系统服务进行交互。

随着 HNX 生态系统的发展，未来将会有更多的用户空间应用程序被开发出来，以丰富操作系统的功能和用户体验。